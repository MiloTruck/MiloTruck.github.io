<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.6 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Voices in the head [1692] - MILOTRUCK</title>
<meta name="description" content="Forensics">


  <meta name="author" content="MiloTruck">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="MILOTRUCK">
<meta property="og:title" content="Voices in the head [1692]">
<meta property="og:url" content="http://localhost:4000/Voices-in-the-head/">


  <meta property="og:description" content="Forensics">







  <meta property="article:published_time" content="2020-12-12T00:00:00+08:00">





  

  


<link rel="canonical" href="http://localhost:4000/Voices-in-the-head/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "MiloTruck",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="_tE-Yah0HQSRNng0bITIKhyyOoGrbpidFdmZFnKylks" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="MILOTRUCK Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/Favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/Favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/Favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/images/Favicon/site.webmanifest">
<link rel="mask-icon" href="/assets/images/Favicon/safari-pinned-tab.svg" color="#636363">
<link rel="shortcut icon" href="/assets/images/Favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-config" content="/assets/images/Favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          MILOTRUCK
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/About/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/Projects/" >Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/Cybersecurity/" >Cybersecurity</a>
            </li><li class="masthead__menu-item">
              <a href="/Data-Science-and-AI/" >Data Science and AI</a>
            </li><li class="masthead__menu-item">
              <a href="/Competitive-Programming/" >Competitive Programming</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/Logo.png" alt="MiloTruck" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">MiloTruck</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Hi. I’m MiloTruck.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Singapore</span>
        </li>
      

      
        
          
            <li><a href="https://milotruck.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Blog</a></li>
          
        
          
        
          
        
          
            <li><a href="https://github.com/MiloTruck" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Voices in the head [1692]">
    <meta itemprop="description" content="Forensics">
    <meta itemprop="datePublished" content="December 12, 2020">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Voices in the head [1692]
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p><strong>Category:</strong> Forensics</p>

<h2 id="challenge-description">Challenge Description</h2>
<blockquote>
  <p>We found a voice recording in one of the forensic images but we have no clue what’s the voice recording about. Are you able to help?</p>
</blockquote>

<h2 id="initial-analysis">Initial Analysis</h2>
<p>We are given a WAV audio file. Sometimes, the spectrogram contains text as seen from previous CTF experience. Using Audacity, the spectrogram of the WAV file can be viewed. To open the spectrogram, click the dropdown arrow on the left panel beside the file name.</p>

<p><img src="https://i.imgur.com/i092acV.jpg" alt="" /></p>

<p><code class="highlighter-rouge">aHR0cHM6Ly9wYXN0ZWJpbi5jb20vakVUajJ1VWI=</code></p>

<p>The text found is a base64 text as seen from the variation of letters used and the <code class="highlighter-rouge">=</code> padding to ensure the length is a multiple of 4. After decoding it (using https://base64decode.org or <code class="highlighter-rouge">base64</code> tool), we find a pastebin link (https://pastebin.com/jETj2uUb) which contains the text below.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++++++++.------------.+.++++++++++.----------.++++++++++.-----.+.+++++..------------.---.+.++++++.-----------.++++++.
</code></pre></div></div>

<p>This is code written in the brainf*ck programming language, notorious for its minimalism. Running this code on an <a href="https://copy.sh/brainfuck/">online compiler</a> yields the text <code class="highlighter-rouge">thisisnottheflag</code>. Welp, looks like a dead end.</p>

<h2 id="back-to-the-wav-file">Back to the WAV file</h2>
<p>After awhile, due to the challenge title not being sufficiently clear, the following hint was given: <code class="highlighter-rouge">Xiao wants to help. Will you let him help you?</code>. The word “Xiao” means “crazy” in the Chinese hokkien dialect. The challenge title “Voices in the head” refers to a crazy person and hence Xiao.</p>

<p>Xiao is a reference to Xiao Steganography. Steganography is a method used for hiding information in files, in this case, WAV files. Using a <a href="https://download.cnet.com/Xiao-Steganography/3000-2092_4-10541494.html">Xiao Steganography decoder</a>, we notice that there is a ZIP file hidden in the WAV file.</p>

<p><img src="https://i.imgur.com/dRBaVrr.png" alt="" /></p>

<p>Upon attempting to extract the files, we realize that the ZIP file is invalid. When viewed in a hex editor, the file signature is incorrect as it does not correspond to a ZIP file as seen from <a href="https://www.garykessler.net/library/file_sigs.html">this website</a>. For those new to CTFs, all files contain a file signature - a fixed pattern of bytes to begin the file, sometimes called magic bytes.</p>

<p>Edit: The Gary Kessler website may have been taken down. You can access the archived website <a href="https://web.archive.org/web/20201111234459/https://www.garykessler.net/library/file_sigs.html">here</a>.</p>

<p><img src="https://i.imgur.com/FYFKg25.png" alt="" /></p>

<p><img src="https://i.imgur.com/rzoqw24.png" alt="" /></p>

<p>Hence, I suspected that the file was encrypted using the Xiao Steganography password field. But what could the password be?</p>

<p>The only string we’ve got is <code class="highlighter-rouge">thisisnottheflag</code> from the brainf*ck code. When this was input into the password field and the ZIP file was extracted, we could finally obtain a valid ZIP file</p>

<p><img src="https://i.imgur.com/s7v67TR.png" alt="" /></p>

<p><img src="https://i.imgur.com/llw63mB.png" alt="" /></p>

<h2 id="extracting-the-zip-contents">Extracting the ZIP contents</h2>
<p>While attempting to extract the ZIP, a password was requested. Since trying the same password (<code class="highlighter-rouge">thisisnottheflag</code>) doesn’t work, looks like we don’t have a password this time. What if the password was stored in plaintext, such as in a comment, in the ZIP? Running <code class="highlighter-rouge">strings</code> would return the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ strings xiao.zip
.
.
.
This is it.docx
govtech-csg{Th1sisn0ty3tthefl@g}PK
</code></pre></div></div>

<p>Similar to the previous string, since they tell you that that text is NOT the flag, it’s most likely the password for the ZIP. Lo and behold, using <code class="highlighter-rouge">govtech-csg{Th1sisn0ty3tthefl@g}</code> as the password extracts all the contents of the ZIP. After opening the docx file inside, we obtain the flag!</p>

<p><img src="https://i.imgur.com/5xnrpdH.png" alt="" /></p>

<p>Flag: <code class="highlighter-rouge">govtech-csg{3uph0n1ou5_@ud10_ch@ll3ng3}</code></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#forensics" class="page__taxonomy-item" rel="tag">Forensics</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#stack-2020" class="page__taxonomy-item" rel="tag">Stack 2020</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-12-12T00:00:00+08:00">December 12, 2020</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Unlock-Me/" class="pagination--pager" title="Unlock Me [905]
">Previous</a>
    
    
      <a href="/Walking-down-a-colourful-memory-lane/" class="pagination--pager" title="Walking down a colourful memory lane [992]
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Working-on/" rel="permalink">What is he working on? Some high value project? [790]
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Open Source Intelligence (OSINT)
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Who-are-the-possible-kidnappers/" rel="permalink">Who are the possible kidnappers? [1990]
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Open Source Intelligence (OSINT)
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Walking-down-a-colourful-memory-lane/" rel="permalink">Walking down a colourful memory lane [992]
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Forensics
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Unlock-Me/" rel="permalink">Unlock Me [905]
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Web
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://milotruck.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Blog</a></li>
        
      
        
      
        
      
        
          <li><a href="https://github.com/MiloTruck" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 MiloTruck. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
